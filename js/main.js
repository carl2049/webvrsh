var camera,controls,scene,renderer,geometry,material,mesh,params={exposure:1,bloomStrength:1,bloomThreshold:.5,bloomRadius:1};function init(){(camera=new THREE.PerspectiveCamera(90,window.innerWidth/window.innerHeight,.01,100)).position.set(-3,1,0),scene=new THREE.Scene,geometry=new THREE.BoxGeometry(.2,.2,.2),material=new THREE.MeshNormalMaterial,renderer=new THREE.WebGLRenderer({antialias:!0});var e=new THREE.SphereBufferGeometry(5,60,40);e.scale(-1,1,1);var n=(new THREE.TextureLoader).load("textures/hdri2.jpg"),r=new THREE.MeshPhongMaterial({map:n,emissiveMap:n});cubemap=new THREE.Mesh(e,r),cubemap.rotation.y=-1.57079633,scene.add(cubemap);var a=new THREE.AmbientLight(16777215,2,2);scene.add(a),renderer.setSize(window.innerWidth,window.innerHeight),renderer.toneMapping=THREE.ReinhardToneMapping,document.body.appendChild(renderer.domElement),(new THREE.FBXLoader).load("models/tron.fbx",function(e,n){scene.add(e),e.scale.set(.005,.005,.005),e.rotation.y=Math.PI});var o=null;var t=new THREE.Raycaster,i=new THREE.Vector3;(controls=new THREE.OrbitControls(camera,renderer.domElement)).enableDamping=!0,controls.dampingFactor=.25,controls.screenSpacePanning=!1,controls.minDistance=1,controls.maxDistance=5,controls.maxPolarAngle=Math.PI/2;var s=new THREE.RenderPass(scene,camera),d=new THREE.UnrealBloomPass(new THREE.Vector2(window.innerWidth,window.innerHeight),1.5,.4,.85);d.threshold=params.bloomThreshold,d.strength=params.bloomStrength,d.radius=params.bloomRadius,composer=new THREE.EffectComposer(renderer),composer.addPass(s),composer.addPass(d),window.addEventListener("click",function(e){e.preventDefault(),o&&(o.material.color.set("#fff"),o=null);var n=function(e,n){return e=e/window.innerWidth*2-1,n=-n/window.innerHeight*2+1,i.set(e,n,.5),t.setFromCamera(i,camera),t.intersectObject(group,!0)}(e.layerX,e.layerY);if(0<n.length){var r=n.filter(function(e){return e&&e.object})[0];r&&r.object&&((o=r.object).material.color.set("#f00"),mesh.rotation.y+=1)}},!1)}function animate(){requestAnimationFrame(animate),controls.update(),renderer.render(scene,camera),composer.render()}init(),animate(),window.onresize=function(){var e=window.innerWidth,n=window.innerHeight;camera.aspect=e/n,camera.updateProjectionMatrix(),renderer.setSize(e,n),composer.setSize(e,n)};